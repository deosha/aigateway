apiVersion: v1
kind: ConfigMap
metadata:
  name: agentgateway-config
  labels:
    app: agentgateway
data:
  config.yaml: |
    # Agent Gateway Configuration for Kubernetes
    # Documentation: https://agentgateway.dev/docs/configuration
    #
    # Agent Gateway handles MCP and A2A protocols.
    # LLM requests go directly to LiteLLM service.

    binds:
      - port: 3000
        listeners:
          - routes:
              # MCP Gateway - Model Context Protocol
              - policies:
                  cors:
                    allowOrigins:
                      - "*"
                    allowHeaders:
                      - mcp-protocol-version
                      - content-type
                      - authorization
                      - accept
                    exposeHeaders:
                      - Mcp-Session-Id
                backends:
                  - mcp:
                      targets:
                        # Filesystem MCP Server
                        - name: filesystem
                          stdio:
                            cmd: npx
                            args:
                              - "-y"
                              - "@modelcontextprotocol/server-filesystem"
                              - "/workspace"

                        # PostgreSQL Database MCP Server
                        - name: database
                          stdio:
                            cmd: npx
                            args:
                              - "-y"
                              - "@modelcontextprotocol/server-postgres"
                              - "postgresql://litellm:litellm@postgresql:5432/litellm"

                        # Brave Search MCP Server
                        - name: brave-search
                          stdio:
                            cmd: npx
                            args:
                              - "-y"
                              - "@modelcontextprotocol/server-brave-search"
